/**
 * @file Firestore Security Rules for Secure Talk
 * @description This ruleset allows everyone to read and write everything.
 * @dataStructure
 * - /users/{userId}: Stores user profile information.
 * - /chats/{chatId}: Stores 1-on-1 chat session information.
 * - /chats/{chatId}/messages/{messageId}: Stores messages within a 1-on-1 chat session.
 * - /users/{userId}/contacts/{contactId}: Stores contact information for a user.
 * - /groups/{groupId}: Stores group chat information.
 * - /groups/{groupId}/messages/{messageId}: Stores messages within a group chat session.
 * @keySecurityDecisions Everything is public now.
 * @denormalizationForAuthorization N/A (everything public).
 * @structuralSegregation N/A (everything public).
 */
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    /**
     * @description Allows everyone to read and write to user documents.
     * @path /users/{userId}
     * @allow (create, update, delete, get, list) Any authenticated user.
     * @deny (none)
     * @principle Allows every one to read and write.
     */
    match /users/{userId} {
      allow get, list: if true;
      allow create, update, delete: if true;
    }

    /**
     * @description Allows everyone to read and write to chat documents.
     * @path /chats/{chatId}
     * @allow (create, update, delete, get, list) Any authenticated user.
     * @deny (none)
     * @principle Allows every one to read and write.
     */
    match /chats/{chatId} {
      allow get, list: if true;
      allow create, update, delete: if true;
    }

    /**
     * @description Allows everyone to read and write to message documents within a chat.
     * @path /chats/{chatId}/messages/{messageId}
     * @allow (create, update, delete, get, list) Any authenticated user.
     * @deny (none)
     * @principle Allows every one to read and write.
     */
    match /chats/{chatId}/messages/{messageId} {
      allow get, list: if true;
      allow create, update, delete: if true;
    }

    /**
     * @description Allows everyone to read and write to contact documents.
     * @path /users/{userId}/contacts/{contactId}
     * @allow (create, update, delete, get, list) Any authenticated user.
     * @deny (none)
     * @principle Allows every one to read and write.
     */
    match /users/{userId}/contacts/{contactId} {
      allow get, list: if true;
      allow create, update, delete: if true;
    }

    /**
     * @description Allows everyone to read and write to group documents.
     * @path /groups/{groupId}
     * @allow (create, update, delete, get, list) Any authenticated user.
     * @deny (none)
     * @principle Allows every one to read and write.
     */
    match /groups/{groupId} {
      allow get, list: if true;
      allow create, update, delete: if true;
    }

    /**
     * @description Allows everyone to read and write to message documents within a group.
     * @path /groups/{groupId}/messages/{messageId}
     * @allow (create, update, delete, get, list) Any authenticated user.
     * @deny (none)
     * @principle Allows every one to read and write.
     */
    match /groups/{groupId}/messages/{messageId} {
      allow get, list: if true;
      allow create, update, delete: if true;
    }
  }
}